Writes a string value to the registry.

If the value doesn't exist it's created. If the key doesn't exist it is also created, but this will only succeed if it's the last key on the hive.